#include <stdio.h>
#include <stdlib.h>
#include <time.h>

/*
    Program Name : Number Puzzle Game
    Description  : Guess the number and save score to file
    Language     : C
*/

// function to save score details in file
void saveScore(char name[], int score, int attempts)
{
    FILE *fp;

    fp = fopen("scorecard.txt", "a");

    if (fp == NULL)
    {
        printf("Error: Unable to open file!\n");
        return;
    }

    fprintf(fp, "Player Name : %s\n", name);
    fprintf(fp, "Score       : %d\n", score);
    fprintf(fp, "Attempts    : %d\n", attempts);
    fprintf(fp, "--------------------------\n");

    fclose(fp);
}

int main()
{
    int randomNumber;
    int guess;
    int attempts;
    int maxAttempts = 5;
    int score;
    char name[50];
    char choice;

    // initialize random number generator
    srand(time(0));

    printf("====================================\n");
    printf("        NUMBER PUZZLE GAME\n");
    printf("====================================\n");

    printf("Enter Player Name: ");
    scanf("%s", name);

    do
    {
        // generate random number between 1 and 100
        randomNumber = rand() % 100 + 1;

        attempts = 0;
        score = 0;

        printf("\nGuess a number between 1 and 100\n");
        printf("Maximum Attempts Allowed: %d\n", maxAttempts);

        // guessing loop
        while (attempts < maxAttempts)
        {
            printf("\nEnter your guess: ");
            scanf("%d", &guess);

            attempts++;

            if (guess == randomNumber)
            {
                printf("Congratulations! Correct Guess üéâ\n");
                score = (maxAttempts - attempts + 1) * 10;
                break;
            }
            else if (guess > randomNumber)
            {
                printf("Your guess is TOO HIGH!\n");
            }
            else
            {
                printf("Your guess is TOO LOW!\n");
            }
        }

        // if user fails to guess
        if (guess != randomNumber)
        {
            printf("\nGame Over ‚ùå\n");
            printf("Correct Number was: %d\n", randomNumber);
            score = 0;
        }

        printf("\nTotal Attempts Used: %d\n", attempts);
        printf("Your Final Score   : %d\n", score);

        // save score to file
        saveScore(name, score, attempts);

        printf("\nDo you want to play again? (y/n): ");
        scanf(" %c", &choice);

    } while (choice == 'y' || choice == 'Y');

    printf("\nThank you for playing the game!\n");
    printf("Your score is saved in 'scorecard.txt'\n");

    return 0;
}
